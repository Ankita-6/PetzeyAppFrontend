<!-- Modal -->
<div
  class="modal fade"
  id="exampleModalCenter"
  tabindex="-1"
  role="dialog"
  aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered mx-auto" role="document">
    <div class="modal-content rounded-4 p-2">
      <div class="ms-2 medicinebox">
        <i class="fa-solid fa-prescription-bottle-medical"></i>
      </div>
      <div class="modal-body ms-2 pt-0">
        <div class="heading mb-2">
          <h4 class="mb-0 pb-0">Medicine</h4>
          <small>Enter Details of Medicine</small>
        </div>
        <div class="medicine-name">
          <label class="fw-bold">Medicine Name</label>
          <div class="search-box mt-2 mb-3">
            <input type="text" placeholder="Search..." />
            <i class="fas fa-search search-icon"></i>
          </div>
        </div>

        <div class="daysANDconsume d-flex row">
          <div class="days col-2">
            <p class="fw-bold">Days</p>
            <input
              class="daysinput"
              [(ngModel)]="prescriptionForm.days"
              type="text"
            />
          </div>

          <div class="consume col-9 ms-3">
            <p class="fw-bold mb-0 pb-0">Consume</p>
            <input
              type="radio"
              name="consume"
              id=""
              value="before"
              [(ngModel)]="prescriptionForm.consume"
            />
            <label for="">Before Food</label>
            <input
              type="radio"
              name="consume"
              id=""
              class="ms-3"
              value="after"
              [(ngModel)]="prescriptionForm.consume"
            />
            <label for="">After Food</label>
          </div>
        </div>

        <div class="dosage mb-3">
          <p class="fw-bold mb-0 pb-0">Dosage</p>
          <input
            type="checkbox"
            [(ngModel)]="prescriptionForm.dosage[0]"
            name="dosage"
            id=""
          />
          <label class="me-3">Morning</label>
          <input
            type="checkbox"
            [(ngModel)]="prescriptionForm.dosage[1]"
            name="dosage"
            id=""
          />
          <label class="me-3">Afternoon</label>
          <input
            type="checkbox"
            [(ngModel)]="prescriptionForm.dosage[2]"
            name="dosage"
            id=""
          />
          <label>Night</label>
        </div>
        <div class="comment">
          <label class="fw-bold">Other Comments</label>
          <textarea
            class="commenttextarea"
            name=""
            id=""
            cols="35"
            rows="3"
            [(ngModel)]="prescriptionForm.comment"
          ></textarea>
        </div>
      </div>
      <!-- modal footer -->
      <div class="d-flex justify-content-around">
        <button
          class="btn btn-light border p-2 ps-3 pe-3"
          data-bs-dismiss="modal"
        >
          Cancel
        </button>
        <button
          data-bs-dismiss="modal"
          class="btn btn-light border p-2 ps-3 pe-3 orange-color-bg"
          (click)="updatePrescription()"
        >
          Confirm
        </button>
      </div>
    </div>
  </div>
</div>

<!-- modal for deleting the medicine -->
<div
  class="modal fade"
  id="deletemedicine"
  tabindex="-1"
  role="dialog"
  aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered mx-auto" role="document">
    <div class="modal-content rounded-4 p-2">
      <div class="ms-2 medicinebox">
        <i class="fa-solid fa-prescription-bottle-medical"></i>
      </div>
      <div class="modal-body ms-2 pt-0">
        <div class="heading mb-2">
          <h4 class="mb-0 pb-2">
            Are you sure you want to delete this Medicine ?
          </h4>
        </div>
        <!-- modal footer -->
        <div class="d-flex justify-content-around">
          <button
            class="btn btn-light border p-2 ps-3 pe-3"
            data-bs-dismiss="modal"
          >
            Cancel
          </button>
          <button
            class="btn btn-light border p-2 ps-3 pe-3 orange-color-bg"
            (click)="confirmDeleteMedicine()"
            data-bs-dismiss="modal"
          >
            Confirm
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="appointmentDetailspage ps-3 p-5">
  <div class="d-flex justify-content-between align-items-center">
    <h5>Appointment Report</h5>
    <div>
      <button
        *ngIf="!isEditing"
        class="btn rounded-2 border shadow-sm mb-1 me-2 fw-bold"
      >
        <i class="fa-solid fa-download me-2"></i>Report
      </button>
      <button
        *ngIf="!isEditing"
        class="btn rounded-2 border shadow-sm mb-1 orange-color-bg fw-bold"
        (click)="enableEdit()"
      >
        <i class="fa-solid fa-pen-to-square me-2"></i>Edit
      </button>
      <button
        *ngIf="isEditing"
        class="btn rounded-2 border shadow-sm mb-1 orange-color-bg fw-bold"
        (click)="save()"
      >
        <i class="fa-solid fa-floppy-disk me-2"></i>Save
      </button>
    </div>
  </div>

  <div class="report mt-3 mb-0">
    <hr class="mt-0" />

    <div class="report-body">
      <div class="row">
        <div class="col-lg-6 col-md-12 mx-auto left-part">
          <div class="precription border shadow p-3 rounded-3">
            <div class="precription-heading d-flex justify-content-between">
              <h4>Precription</h4>
              <button
                *ngIf="isEditing"
                class="btn rounded-2 border shadow-sm mb-1 orange-color-bg fw-bold"
                (click)="activatePrescriptionModal(0)"
                data-bs-toggle="modal"
                data-bs-target="#exampleModalCenter"
              >
                <i class="fa-solid fa-plus me-2"></i>Medicine
              </button>
            </div>
            <div class="all-item-list p-3">
              @for (prescription of report.Prescription.PrescribedMedicines;
              track $index) {
              <div class="precription-item border rounded-3 shadow-sm mt-2 p-3">
                <div class="medicine-name d-flex justify-content-between">
                  <h6>
                    {{
                      $index + 1 + ". " + prescription.Medicine?.MedicineName
                    }}
                  </h6>

                  <div *ngIf="isEditing">
                    <button
                      class="btn"
                      data-bs-toggle="modal"
                      data-bs-target="#exampleModalCenter"
                      (click)="
                        activatePrescriptionModal(
                          prescription.PrescribedMedicineID
                        )
                      "
                    >
                      <i class="fa-solid fa-pencil fw-bold orange-color"></i>
                    </button>
                    <button
                      class="btn"
                      data-bs-toggle="modal"
                      data-bs-target="#deletemedicine"
                      (click)="
                        setDeleteMedicineID(prescription.PrescribedMedicineID)
                      "
                    >
                      <i class="fa-solid fa-x fw-bold orange-color"></i>
                    </button>
                  </div>
                </div>
                <small>Days: {{ prescription.NumberOfDays }}</small>
                <div class="d-flex justify-content-between">
                  <small class="my-auto">{{ prescription.Comment }}</small>
                  <div *ngIf="prescription.Consume" class="capsule2">
                    before-food
                  </div>
                  <div *ngIf="!prescription.Consume" class="capsule2">
                    after-food
                  </div>
                </div>
                <div class="d-flex justify-content-end align-items-center mt-2">
                  <div class="circular-div">
                    @if(prescription.Dosages==0 || prescription.Dosages==3 || prescription.Dosages==4 || prescription.Dosages==6)
                    {

                      <span class="tick-mark">&#10003;</span>
                    }
                  </div>
                  <div class="line"></div>
                  <div class="circular-div">
                    @if(prescription.Dosages==1 || prescription.Dosages==3 || prescription.Dosages==5 || prescription.Dosages==6)
                    {

                      <span class="tick-mark">&#10003;</span>
                    }
                  </div>
                  <div class="line"></div>
                  <div class="circular-div">
                    @if(prescription.Dosages==2 || prescription.Dosages==4 || prescription.Dosages==5 || prescription.Dosages==6)
                    {

                      <span class="tick-mark">&#10003;</span>
                    }
                  </div>
                </div>
              </div>
              }
            </div>
          </div>

          <div class="recommendeddr border shadow mt-4 mb-4 p-3 pe-0 rounded-3">
            <h4>Recommended Doctor's</h4>
            <div *ngIf="isEditing" class="search-box ps-3 mt-2">
              <input type="text" placeholder="Search..." />
              <i class="fas fa-search search-icon"></i>
            </div>
            <div class="all-item-list mt-4 ps-3">
              @for (doctors of report.RecommendedDoctors; track $index) {
              <div class="capsule">{{ doctors.DoctorID }}</div>
              }
            </div>
          </div>
        </div>

        <div class="col-lg-6 col-md-12 mx-auto right-part">
          <div class="vitals border shadow mb-4 p-3 pe-0 rounded-3">
            <h4>Vitals</h4>
            <div class="icons mt-4 ps-3">
              <div class="icon-container me-5 d-inline-block">
                <div class="mb-2"><i class="fa-regular fa-heart icon"></i></div>
                <span class="icon-text">
                  <b *ngIf="!isEditing">{{ report.HeartRate }}</b>
                  <input
                    *ngIf="isEditing"
                    type="text"
                    [(ngModel)]="report.HeartRate"
                    (keypress)="validateNumber($event)"
                    class="underline-input"
                    required
                  />
                  HR</span
                >
              </div>

              <div class="icon-container me-5 d-inline-block">
                <div class="mb-2">
                  <i class="fa-solid fa-thermometer icon"></i>
                </div>
                <span class="icon-text">
                  <b *ngIf="!isEditing">{{ report.Temperature }}</b>
                  <input
                    *ngIf="isEditing"
                    type="text"
                    [(ngModel)]="report.Temperature"
                    (keypress)="validateNumber($event)"
                    class="underline-input"
                    required
                  />

                  &deg;C</span
                >
              </div>

              <div class="icon-container d-inline-block">
                <div class="mb-2"><i class="fa-solid fa-lungs icon"></i></div>
                <span class="icon-text">
                  <b *ngIf="!isEditing">{{ report.OxygenLevel }}</b>
                  <input
                    *ngIf="isEditing"
                    type="text"
                    [(ngModel)]="report.OxygenLevel"
                    (keypress)="validateNumber($event)"
                    class="underline-input"
                    required
                  />

                  BPM</span
                >
              </div>
            </div>
          </div>
          <div class="symptoms border shadow mb-4 p-3 pe-0 rounded-3">
            <h4>Symptoms</h4>
            <div *ngIf="isEditing" class="search-box ps-3 mt-2">
              <form *ngIf="isEditing" [formGroup]="myForm">
                <ng-multiselect-dropdown
                  name="symptom"
                  [settings]="symptomSettings"
                  [placeholder]="'Select Symptoms'"
                  [data]="symptoms"
                  formControlName="symptom"
                  [disabled]="disabled"
                  (onSelect)="onSelectSymptom($event)"
                  (onDeSelect)="onDeselectSymptom($event)"
                >
                </ng-multiselect-dropdown>
              </form>
            </div>
            <div *ngIf="!isEditing" class="all-item-list mt-4 ps-3">
              @for (symptoms of report.Symptoms; track $index) {
              <div class="capsule">
                {{ getSymptomById(symptoms.SymptomID)?.SymptomName }}
              </div>
              }
            </div>
          </div>
          <div class="tests border shadow mb-4 p-3 pe-0 rounded-3">
            <h4>Tests</h4>
            <div *ngIf="isEditing" class="search-box ps-3 mt-2">
              <form *ngIf="isEditing" [formGroup]="myForm">
                <ng-multiselect-dropdown
                  name="test"
                  [settings]="testSettings"
                  [placeholder]="'Select Tests'"
                  [data]="tests"
                  formControlName="test"
                  [disabled]="disabled"
                  (onSelect)="onSelectTest($event)"
                  (onDeSelect)="onDeselectTest($event)"
                >
                </ng-multiselect-dropdown>
              </form>
            </div>
            <div *ngIf="!isEditing" class="all-item-list mt-4 ps-3">
              @for (tests of report.Tests; track $index) {
              <div class="capsule">
                {{ getTestById(tests.TestID)?.TestName }}
              </div>
              }
            </div>
          </div>
        </div>

        <div class="col-lg-12 col-md-12 mx-auto bottom-part">
          <div
            class="commentsbydoctor col-lg-12 col-md-12 border shadow p-3 rounded-3"
          >
            <h4>Comments</h4>

            <div *ngIf="!isEditing" class="comment-body mt-3 ms-2 d-flex">
              <img src="" alt="" />
              <div class="comment-info ms-3">
                <p class="m-0 d-inline-block fw-bolder">Dr. Pal Manikam</p>
                <small class="ms-2">10 hr ago</small>
                <p>{{ report.Comment }}</p>
              </div>
            </div>
            <input
              class="comment-input mt-4"
              *ngIf="isEditing"
              type="text"
              [(ngModel)]="report.Comment"
            />
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
